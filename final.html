<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stream песни</title>
    <style>
        @font-face {
            font-family: 'Inter';
            src: url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            height: 100vh;
            overflow: hidden;
            color: white;
            position: relative;
            transition: background-color 0.6s ease;
        }

        .background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            transition: opacity 1s ease;
            overflow: hidden;
        }

        .background-image, .background-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 1s ease;
        }

        .background-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 100%);
            z-index: 1;
        }

        .background.grain::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400" viewBox="0 0 400 400"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"/><feColorMatrix type="saturate" values="0"/></filter><rect width="100%" height="100%" filter="url(%23noise)" opacity="0.06"/></svg>');
            z-index: 2;
            pointer-events: none;
        }

        .header {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
        }

        .song-title {
            font-size: 1.2rem;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .song-artist {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 4px;
        }

        .lyrics-line {
    text-align: center;
    opacity: 0.4;
    font-size: clamp(16px, 3vw, 24px);
    transform: scale(0.9);
    height: 60px;
    margin: 10px 0;
    transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    text-shadow: 0 2px 8px rgba(0,0,0,0.4);
    will-change: transform, opacity, font-size;
}

.lyrics-line.active {
    opacity: 1;
    font-size: clamp(25px, 4vw, 57px);
    font-weight: 600;
    transform: scale(1);
    white-space: nowrap;

    /* Эффект свечения */
    color: #ffffff;
    text-shadow:

        0 0 32px rgba(0, 174, 255, 0.3);
}

.lyrics-container {
    position: absolute;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%);
    overflow: hidden; 
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
}

.lyrics-track {
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: transform 0.5s ease-in-out;
    will-change: transform;
}

        .lyrics-line.hidden {
            opacity: 0;
            transform: translateY(60px) scale(0.8);
        }

        @media (max-width: 768px) {
            .lyrics-line.current {
                font-size: clamp(24px, 8vw, 48px);
            }
        }
    </style>
</head>
<body>
    <div class="background" id="background">
        <div class="background-overlay"></div>
    </div>
    
    <div class="header">
        <div class="song-title" id="song-title"></div>
        <div class="song-artist" id="song-artist"></div>
    </div>
    
    <div class="lyrics-container" id="lyrics-container"></div>

    <script>
        // Конфигурация приложения
        const config = {
            loopLines: false,
            autoplayEnabled: false,
            autoplayIntervalMs: 1400,
            initialSongId: "nenavizhu"
        };

        // Данные песен
        const songs = [
            {
                "id": "nenavizhu",
                "title": "Ненавижу",
                "artist": "Иван Дорн",
                "lines": [
"Был обычный день, точно не весна",
"Я помню, как теперь, что ты была одна",
"И разносила письма, yeah, а я попал в зависимость",
"Пепел сигареты и одинокий в парк",
"Сто один совет, как сделать первый шаг",
"Кусаю ногти до крови, а сам стесняюсь подойти",
"Ненавижу, ненавижу я себя",
"Потому что знают все мои друзья",
"Что я признаюсь, ну а ты не скажешь «Да»",
"Мне будет стыдно, будет стыдно",
"Коротаю дни, ждать не хочется",
"Я спасаюсь от одиночества",
"Я жду твой взгляд так искренне",
"Который занят письмами",
"Снова сам себе жалуюсь на ум",
"Денег нет нигде, а я купил парфюм",
"Назло красивым облакам тебя приманит запахом",
"Ненавижу, ненавижу я себя",
"Потому что знают все мои друзья",
"Что я признаюсь, ну а ты не скажешь «Да»",
"Мне будет стыдно, будет стыдно",
"Ненавижу, ненавижу я себя",
"Потому что знают все мои друзья",
"Что я признаюсь, ну а ты не скажешь «Да»",
"Мне будет стыдно, будет стыдно",
"Ты была нежной, пересекая мой двор",
"Я безуспешно пытался начать разговор",
"Нарушив предложений план",
"А ты и так всё поняла",
"Ты скажешь",
"Мне будет стыдно",
"Мне будет стыдно",
"Ты скажешь",
"Мне будет стыдно",
"Мне будет стыдно",
"Ты скажешь",
"Мне будет стыдно",
"Мне будет стыдно",
"Ты скажешь",
"Мне будет стыдно",
"Ненавижу, ненавижу я себя",
"Потому что знают все мои друзья",
"Что я признаюсь, ну а ты не скажешь «Да»",
"Мне будет стыдно, будет стыдно",
"Ненавижу, ненавижу я себя",
"Потому что знают все мои друзья",
"Что я признаюсь",
"Ну а ты не скажешь «Да»",
"Мне будет стыдно, стыдно",
"Ненавижу , ненавижу я себя",
"Потому что знают все мои друзья",
"Что я признаюсь",
"Ну а ты не скажешь «Да»",
"Мне будет стыдно, стыдно"
                ],
                "theme": {
                    "primary": "#D94D6A",
                    "secondary": "#2E2A3B",
                    "backgroundType": "gif",
                    "backgroundMedia": "https://images.hdqwalls.com/download/warm-sunset-4k-ou-3840x2400.jpg",
                    "grain": true
                }
            },
            {
                "id": "Summertime_Sadness",
                "title": "Summertime Sadness",
                "artist": "Lana Del Rey",
                "lines": [
                "Kiss me hard before you go",
"Summertime sadness",
"I just wanted you to know",
"That, baby, you the best",
"I got my red dress on tonight",
"Dancin' in the dark, in the pale moonlight",
"Done my hair up real big, beauty queen style",
"High heels off, I'm feelin' alive",
"Oh my God, I feel it in the air",
"Telephone wires above are sizzlin' like a snare",
"Honey, I'm on fire, I feel it everywhere",
"Nothin' scares me anymore (one, two, three, four)",
"Kiss me hard before you go",
"Summertime sadness",
"I just wanted you to know",
"That, baby, you the best",
"I got that summertime, summertime sadness",
"Su-su-summertime, summertime sadness",
"Got that summertime, summertime sadness",
"Oh, oh-oh, oh-oh",
"I'm feelin' electric tonight",
"Cruisin' down the coast, goin' 'bout 99",
"Got my bad baby by my heavenly side",
"I know if I go, I'll die happy tonight",
"Oh my God, I feel it in the air",
"Telephone wires above are sizzlin' like a snare",
"Honey, I'm on fire, I feel it everywhere",
"Nothin' scares me anymore (one, two, three, four)",
"Kiss me hard before you go",
"Summertime sadness",
"I just wanted you to know",
"That, baby, you the best",
"I got that summertime, summertime sadness",
"Su-su-summertime, summertime sadness",
"Got that summertime, summertime sadness",
"Oh, oh-oh, oh-oh",
"Think I'll miss you forever",
"Like the stars miss the sun in the morning sky",
"Later's better than never",
"Even if you're gone, I'm gonna drive (drive), drive",
"I got that summertime, summertime sadness",
"Su-su-summertime, summertime sadness",
"Got that summertime, summertime sadness",
"Oh, oh-oh, oh-oh",
"Kiss me hard before you go",
"Summertime sadness",
"I just wanted you to know",
"That, baby, you the best",
"I got that summertime, summertime sadness",
"Su-su-summertime, summertime sadness",
"Got that summertime, summertime sadness",
"Oh, oh-oh, oh-oh"
                ],
                "theme": {
                    "primary": "#D94D6A",
                    "secondary": "#2E2A3B",
                    "backgroundType": "gif",
                    "backgroundMedia": "https://images.hdqwalls.com/download/warm-sunset-4k-ou-3840x2400.jpg",
                    "grain": true
                }
            },
            {
                "id": "Story_of_My_Life",
                "title": "Story of My Life",
                "artist": "One Direction",
                "lines": [
                "Story of my life",
"Written in these walls are the stories that I can't explain",
"I leave my heart open, but it stays right here empty for days",
"She told me in the mornin' she don't feel the same about us in her bones",
"It seems to me that when I die, these words will be written on my stone",
"And I'll be gone, gone tonight",
"The ground beneath my feet is open wide",
"The way that I've been holding on too tight",
"With nothing in between",
"The story of my life, I take her home",
"I drive all night to keep her warm",
"And time is frozen",
"The story of my life, I give her hope",
"I spend her love until she's broke inside",
"The story of my life",
"Written on these walls are the colors that I can't change",
"Leave my heart open, but it stays right here in its cage",
"I know that in the mornin', I'll see us in the light up on the hill",
"Although I am broken, my heart is untamed still",
"And I'll be gone, gone tonight",
"The fire beneath my feet is burning bright",
"The way that I've been holding on so tight",
"With nothing in between",
"The story of my life, I take her home",
"I drive all night to keep her warm",
"And time is frozen",
"The story of my life, I give her hope",
"I spend her love until she's broke inside",
"The story of my life",
"And I've been waiting for this time to come around",
"But, baby, running after you is like chasin' the clouds",
"The story of my life, I take her home",
"I drive all night to keep her warm",
"And time is frozen",
"The story of my life, I give her hope",
"I spend her love until she's broke inside",
"The story of my life",
"The story of my life",
"The story of my life",
"The story of my life"
                ],
                "theme": {
                    "primary": "#D94D6A",
                    "secondary": "#2E2A3B",
                    "backgroundType": "gif",
                    "backgroundMedia": "https://images.hdqwalls.com/download/warm-sunset-4k-ou-3840x2400.jpg",
                    "grain": true
                }
            },
            {
                "id": "Big_Time_Rush",
                "title": "Big Time Rush",
                "artist": "Big Time Rush",
                "lines": [
                "Oh, oh, oh-oh-oh",
"Big time rush",
"Oh, oh, oh-oh-oh",
"Oh, oh, oh-oh-oh",
"Oh, oh, oh-oh-oh",
"Make it count, play it straight",
"Don't look back, don't hesitate when you go big time",
"What you want, what you feel",
"Never quit it, make it real when you roll big time",
"Hey, hey",
"Listen to your heart now",
"Hey, hey",
"Don't you feel the rush?",
"Hey, hey",
"Better take your shot now",
"Oh-oh, oh-oh, oh-oh, oh-oh",
"Go and shake it up, what you gotta lose?",
"Go and make your luck with the life you choose",
"If you want it all, lay it on the line",
"It's the only life ya got, so ya gotta live it big time",
"Oh, oh, oh-oh-oh",
"Oh, oh, oh-oh-oh",
"Step it up, get in gear, go for broke, make it clear",
"Gotta go big time",
"Make it work, get it right, change the world over night",
"Gotta dream big time",
"Hey, hey, give it all you got now",
"Hey, hey, isn't it a rush?",
"Hey, hey, finish what you start now",
"Oh-oh, oh-oh, oh-oh, oh-oh",
"Go and shake it up, what you gotta lose?",
"Go and make your luck with the life you choose",
"If you want it all, lay it on the line",
"It's the only life ya got, so ya gotta live it big time",
"If you want it all, lay it on the line",
"It's the only life ya got, so ya gotta live it big time",
"Oh, oh, oh-oh-oh,gotta live it big time",
"Oh, oh, oh-oh-oh,gotta live it big time",
"Oh, oh, oh-oh-oh,gotta live it big time",
"Oh, oh, oh-oh-oh,gotta live it big time",

                ],
                "theme": {
                    "primary": "#D94D6A",
                    "secondary": "#2E2A3B",
                    "backgroundType": "gif",
                    "backgroundMedia": "https://images.hdqwalls.com/download/warm-sunset-4k-ou-3840x2400.jpg",
                    "grain": true
                }
            },
        ];

        // Состояние приложения
        let state = {
            currentSongIndex: songs.findIndex(song => song.id === config.initialSongId),
            currentLineIndex: 0,
            isHelpVisible: false,
            isAutoplay: false,
            autoplayInterval: null,
            keyHold: {
                up: false,
                down: false,
                interval: null,
                speed: 200,
                minSpeed: 80,
                acceleration: 20
            }
        };

        // DOM элементы
        const elements = {
            background: document.getElementById('background'),
            lyricsContainer: document.getElementById('lyrics-container'),
            songTitle: document.getElementById('song-title'),
            songArtist: document.getElementById('song-artist'),
            helpOverlay: document.getElementById('help-overlay'),
        };

        // Инициализация приложения
        function init() {
            if (state.currentSongIndex === -1) state.currentSongIndex = 0;
            
            renderSong();
            renderLines();
            setupEventListeners();
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            // Клавиатура
            window.addEventListener('keydown', handleKeyDown);
            window.addEventListener('keyup', handleKeyUp);
            
            // Полноэкранный режим по клику
            document.addEventListener('click', () => {
                if (!state.isHelpVisible) {
                    document.documentElement.requestFullscreen?.().catch(err => {
                        console.log('Fullscreen error:', err);
                    });
                }
            });
        }

        // Обработка нажатия клавиш
        function handleKeyDown(e) {
            
            // Навигация по строкам
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                nextLine();
                startKeyHold('down');
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                prevLine();
                startKeyHold('up');
            }
            
            // Навигация по песням
            if (e.shiftKey) {
                if (e.key === 'ArrowRight') {
                    e.preventDefault();
                    nextSong();
                } else if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    prevSong();
                }
            }
        }

        // Обработка отпускания клавиш
        function handleKeyUp(e) {
            if (e.key === 'ArrowDown') {
                stopKeyHold();
            } else if (e.key === 'ArrowUp') {
                stopKeyHold();
            }
        }

        // Начало удержания клавиши
        function startKeyHold(direction) {
            if (state.keyHold.interval) return;
            
            state.keyHold[direction] = true;
            state.keyHold.speed = 200;
            
            state.keyHold.interval = setInterval(() => {
                if (direction === 'down') {
                    nextLine();
                } else {
                    prevLine();
                }
                
                // Ускорение при удержании
                state.keyHold.speed = Math.max(
                    state.keyHold.minSpeed, 
                    state.keyHold.speed - state.keyHold.acceleration
                );
                
                // Обновление интервала
                clearInterval(state.keyHold.interval);
                state.keyHold.interval = setInterval(() => {
                    if (direction === 'down') {
                        nextLine();
                    } else {
                        prevLine();
                    }
                }, state.keyHold.speed);
            }, state.keyHold.speed);
        }

        // Остановка удержания клавиши
        function stopKeyHold() {
            clearInterval(state.keyHold.interval);
            state.keyHold.interval = null;
            state.keyHold.up = false;
            state.keyHold.down = false;
        }

        // Следующая песня
        function nextSong() {
            state.currentSongIndex = (state.currentSongIndex + 1) % songs.length;
            state.currentLineIndex = 0;
            changeSong();
        }

        // Предыдущая песня
        function prevSong() {
            state.currentSongIndex = (state.currentSongIndex - 1 + songs.length) % songs.length;
            state.currentLineIndex = 0;
            changeSong();
        }

        // Смена песни
        function changeSong() {
            renderSong();
            renderLines();
        }

        // Отрисовка песни (фона и заголовка)
        function renderSong() {
            const song = songs[state.currentSongIndex];
            
            // Установка заголовка
            elements.songTitle.textContent = song.title;
            elements.songArtist.textContent = song.artist;
            
            // Установка фона
            const theme = song.theme;
            
            // Очищаем предыдущие медиа
            const oldMedia = elements.background.querySelector('.background-image, .background-video');
            if (oldMedia) oldMedia.remove();
            
            // Создаем новое медиа
            if (theme.backgroundType === 'video' && theme.backgroundMedia) {
                const video = document.createElement('video');
                video.className = 'background-video';
                video.src = theme.backgroundMedia;
                video.autoplay = true;
                video.loop = true;
                video.muted = true;
                video.playsInline = true;
                elements.background.insertBefore(video, elements.background.firstChild);
            } 
            else if (theme.backgroundType === 'gif' && theme.backgroundMedia) {
                const img = document.createElement('img');
                img.className = 'background-image';
                img.src = theme.backgroundMedia;
                elements.background.insertBefore(img, elements.background.firstChild);
            }
            else {
                // Градиентный фон
                const gradient = `linear-gradient(135deg, ${theme.secondary} 0%, ${theme.primary} 100%)`;
                elements.background.style.background = gradient;
                elements.background.style.backgroundColor = theme.primary;
            }
            
            // Зерно
            if (theme.grain) {
                elements.background.classList.add('grain');
            } else {
                elements.background.classList.remove('grain');
            }
            
            // Цвет текста (для лучшей читаемости)
            const textColor = getContrastColor(theme.primary);
            document.body.style.color = textColor;
        }

        // Отрисовка строк
        function renderLines() {
            const song = songs[state.currentSongIndex];
            const lines = song.lines;
            
            // Создаем обертку для трека, если её нет
            if (!elements.lyricsTrack) {
                elements.lyricsTrack = document.createElement('div');
                elements.lyricsTrack.className = 'lyrics-track';
                elements.lyricsContainer.innerHTML = '';
                elements.lyricsContainer.appendChild(elements.lyricsTrack);
            }
            
            // Очищаем трек
            elements.lyricsTrack.innerHTML = '';
            
            // Добавляем все строки
            lines.forEach((line, idx) => {
                const lineEl = document.createElement('div');
                lineEl.className = 'lyrics-line';
                if (idx === state.currentLineIndex) lineEl.classList.add('active');
                lineEl.textContent = line;
                elements.lyricsTrack.appendChild(lineEl);
            });
            
            updateTrackPosition();
        }

        function updateTrackPosition() {
            if (!elements.lyricsTrack) return;
            
            const activeLine = elements.lyricsTrack.querySelector('.lyrics-line.active');
            if (!activeLine) return;
            
            const lineHeight = activeLine.offsetHeight + 20;
            const wrapperHeight = elements.lyricsContainer.offsetHeight;
            const centerOffset = wrapperHeight / 2 - lineHeight / 2;
            const activeIndex = state.currentLineIndex;
            const offset = activeIndex * lineHeight;
            
            elements.lyricsTrack.style.transform = `translateY(${centerOffset - offset}px)`;
        }

        function nextLine() {
            const currentSong = songs[state.currentSongIndex];
            if (state.currentLineIndex < currentSong.lines.length - 1) {
                state.currentLineIndex++;
                updateLines();
            } else if (config.loopLines) {
                state.currentLineIndex = 0;
                updateLines();
            }
        }

        function prevLine() {
            if (state.currentLineIndex > 0) {
                state.currentLineIndex--;
                updateLines();
            } else if (config.loopLines) {
                const currentSong = songs[state.currentSongIndex];
                state.currentLineIndex = currentSong.lines.length - 1;
                updateLines();
            }
        }

        function updateLines() {
            const lines = elements.lyricsTrack.querySelectorAll('.lyrics-line');
            lines.forEach((line, idx) => {
                line.classList.remove('active');
                if (idx === state.currentLineIndex) line.classList.add('active');
            });
            updateTrackPosition();
        }

        // Создание элемента строки
        function createLineElement(text, type) {
            const lineEl = document.createElement('div');
            lineEl.className = `lyrics-line ${type}`;
            lineEl.textContent = text;
            return lineEl;
        }

        // Получение контрастного цвета
        function getContrastColor(hexColor) {
            // Если цвет очень светлый, возвращаем чёрный, иначе белый
            const r = parseInt(hexColor.substr(1, 2), 16);
            const g = parseInt(hexColor.substr(3, 2), 16);
            const b = parseInt(hexColor.substr(5, 2), 16);
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            return brightness > 128 ? '#000000' : '#FFFFFF';
        }

        // Запуск приложения
        init();
    </script>
</body>
</html>